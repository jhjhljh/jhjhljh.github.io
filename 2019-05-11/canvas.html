<!doctype html>


  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<script>
    (function () {
        if ('') {
            if (prompt('请输入文章密码') !== '') {
                alert('密码错误！');
                if (history.length === 1) {
                    location.replace("http://jhjhljh.github.io"); // 这里替换成你的首页
                } else {
                    history.back();
                }
            }
        }
    })();
</script>


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">











  
  
    
  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css">


<link href="https://fonts.loli.net/css?family=EB+Garamond:500,500i,700,700i|Noto+Serif+SC:400,500,700&display=swap" rel="stylesheet">



  

<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css">


  <meta name="keywords" content="canvas,">





  <link rel="alternate" href="/atom.xml" title="Abo" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="http://pzdbj8uw8.bkt.clouddn.com/favicon.ico?v=5.1.3">






<meta name="description" content="canvas画布，不容小觑的“标签”，得有一定的数学几何底子，虽然目前我还是没用到就是了，但是以后总该会用到的，有想过利用canvas制作小游戏_〆(´Д｀ ) canvas画布，顾名思义即是如图所示绘图的“工具”，然而并不简单(lll￢ω￢)~">
<meta name="keywords" content="canvas">
<meta property="og:type" content="article">
<meta property="og:title" content="canvas学习笔记">
<meta property="og:url" content="http://jhjhljh.github.io/2019-05-11/canvas.html">
<meta property="og:site_name" content="Abo">
<meta property="og:description" content="canvas画布，不容小觑的“标签”，得有一定的数学几何底子，虽然目前我还是没用到就是了，但是以后总该会用到的，有想过利用canvas制作小游戏_〆(´Д｀ ) canvas画布，顾名思义即是如图所示绘图的“工具”，然而并不简单(lll￢ω￢)~">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/business-1031754_1280.jpg">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/canvas-x-y.png">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/fill-0-prin.jpg">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/arc.gif">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/textAsign.png">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/font-line1.png">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/textBaseline.gif">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/prototype.png">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/linecap.png">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/linejoin.png">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/MiterLimet.png">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/quadraticcurve.gif">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/beziercurve.gif">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/canvas-arcto-1.png">
<meta property="og:image" content="http://jhjhljh.github.io/2019-05-11/canvas/圆形点的坐标计算公式.png">
<meta property="og:updated_time" content="2019-10-26T14:30:52.329Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="canvas学习笔记">
<meta name="twitter:description" content="canvas画布，不容小觑的“标签”，得有一定的数学几何底子，虽然目前我还是没用到就是了，但是以后总该会用到的，有想过利用canvas制作小游戏_〆(´Д｀ ) canvas画布，顾名思义即是如图所示绘图的“工具”，然而并不简单(lll￢ω￢)~">
<meta name="twitter:image" content="http://jhjhljh.github.io/2019-05-11/canvas/business-1031754_1280.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: "",
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: "",
      labels: ""
    }
  };
</script>



  <link rel="canonical" href="http://jhjhljh.github.io/2019-05-11/canvas.html">





<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>


  <title> canvas学习笔记 | Abo </title>
<link rel="stylesheet" href="\assets\css\APlayer.min.css" class="aplayer-style-marker">
<script src="\assets\js\APlayer.min.js" class="aplayer-script-marker"></script>
</head>

  	 <!-- custom analytics part create by xiamo -->
<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
<script>AV.initialize("W0twhOKHT901IOCEADaiuynP-gzGzoHsz", "zQfRdGCiWzVvsSpXKOJsbvHe");</script>
<script>
function showTime(Counter) {
	var query = new AV.Query(Counter);
	$(".leancloud_visitors").each(function() {
		var url = $(this).attr("id").trim();
		query.equalTo("url", url);
		query.find({
			success: function(results) {
				if (results.length == 0) {
					var content = $(document.getElementById(url)).text() + ': 0';
					$(document.getElementById(url)).text(content);
					return;
				}
				for (var i = 0; i < results.length; i++) {
					var object = results[i];
					var content = $(document.getElementById(url)).text() + ': ' + object.get('time');
					$(document.getElementById(url)).text(content);
				}
			},
			error: function(object, error) {
				console.log("Error: " + error.code + " " + error.message);
			}
		});

	});
}

function addCount(Counter) {
	var Counter = AV.Object.extend("Counter");
	url = $(".leancloud_visitors").attr('id').trim();
	title = $(".leancloud_visitors").attr('data-flag-title').trim();
	var query = new AV.Query(Counter);
	query.equalTo("url", url);
	query.find({
		success: function(results) {
			if (results.length > 0) {
				var counter = results[0];
				counter.fetchWhenSave(true);
				counter.increment("time");
				counter.save(null, {
					success: function(counter) {
						var content = $(document.getElementById(url)).text() + ': ' + counter.get('time');
						$(document.getElementById(url)).text(content);
					},
					error: function(counter, error) {
						console.log('Failed to save Visitor num, with error message: ' + error.message);
					}
				});
			} else {
				var newcounter = new Counter();
				newcounter.set("title", title);
				newcounter.set("url", url);
				newcounter.set("time", 1);
				newcounter.save(null, {
					success: function(newcounter) {
					    console.log("newcounter.get('time')="+newcounter.get('time'));
						var content = $(document.getElementById(url)).text() + ': ' + newcounter.get('time');
						$(document.getElementById(url)).text(content);
					},
					error: function(newcounter, error) {
						console.log('Failed to create');
					}
				});
			}
		},
		error: function(error) {
			console.log('Error:' + error.code + " " + error.message);
		}
	});
}
$(function() {
	var Counter = AV.Object.extend("Counter");
	if ($('.leancloud_visitors').length == 1) {
		addCount(Counter);
	} else if ($('.post-title-link').length > 1) {
		showTime(Counter);
	}
});
</script>
  


<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">
  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4f040a6ebf9ae0c7337c462df961942c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  
  
  <div class="container one-collumn  page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Abo</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <h1 class="site-subtitle" itemprop="description">林加鸿</h1>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-futbol-o"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-top">
          <a href="/top" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-signal"></i> <br>
            
            排行
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://jhjhljh.github.io/2019-05-11/canvas.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="林加鸿">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Abo">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Abo" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                canvas学习笔记
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-05-11T20:12:07+08:00">
                2019-05-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/canvas/" itemprop="url" rel="index">
                    <span itemprop="name">canvas</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                 <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019-05-11/canvas.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019-05-11/canvas.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
		  
			 
          
          
             <span id="/2019-05-11/canvas.html" class="leancloud_visitors" data-flag-title="canvas学习笔记">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">热度 </span>
               
                 <span class="leancloud-visitors-count"></span>
				 <span>℃</span>
             </span>
          
		   
          

		  
            <div class="post-wordcount">
              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  8.3k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  33
                </span>
              
            </div>
          
		  
          
 
        


        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p></p><p class="description">canvas画布，不容小觑的“标签”，得有一定的数学几何底子，虽然目前我还是没用到就是了，但是以后总该会用到的，有想过利用canvas制作小游戏_〆(´Д｀ )</p><p></p>
<p><blockquote class="question">canvas画布，顾名思义即是如图所示绘图的“工具”，然而并不简单(lll￢ω￢)~</blockquote><br><img src="/2019-05-11/canvas/business-1031754_1280.jpg" alt="business-1031754_1280"></p>
<a id="more"></a>
<p><blockquote class="question">最近毛毛的《奉献》特别耐人寻味，有跟原版不一样的感觉~</blockquote><br>
        <div id="aplayer-hRdKVImB" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">
            <pre class="aplayer-lrc-content"></pre>
        </div>
        <script>
          var ap = new APlayer({
            element: document.getElementById("aplayer-hRdKVImB"),
            narrow: false,
            autoplay: false,
            showlrc: false,
            music: {
              title: "奉献",
              author: "毛不易",
              url: "http://psu4sovbi.bkt.clouddn.com/%E5%A5%89%E7%8C%AE.mp3",
              pic: "http://psu4sovbi.bkt.clouddn.com/maomao.jpg",
              lrc: ""
            }
          });
          window.aplayers || (window.aplayers = []);
          window.aplayers.push(ap);
        </script></p>
<h1 id="canvas简介"><a href="#canvas简介" class="headerlink" title="canvas简介"></a>canvas简介</h1><h2 id="什么是canvas？（了解）"><a href="#什么是canvas？（了解）" class="headerlink" title="什么是canvas？（了解）"></a>什么是canvas？（了解）</h2><ul>
<li>是HTML5提供的一种新标签</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">canvas</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span></span><br><span class="line"> 英 [<span class="string">'kænvəs]  美 ['</span>kænvəs]   帆布 画布</span><br></pre></td></tr></table></figure>
<ul>
<li>Canvas是一个矩形区域的画布，可以用JavaScript在上面绘画。控制其每一个像素。</li>
<li>canvas 标签使用 JavaScript 在网页上绘制图像，本身不具备绘图功能。</li>
<li>canvas 拥有多种绘制路径、矩形、圆形、字符以及添加图像的方法。</li>
<li>HTML5之前的web页面只能用一些固定样式的标签：比如p、div、h1等</li>
</ul>
<h2 id="canvas主要应用的领域（了解）"><a href="#canvas主要应用的领域（了解）" class="headerlink" title="canvas主要应用的领域（了解）"></a>canvas主要应用的领域（了解）</h2><ol>
<li>游戏：canvas在基于Web的图像显示方面比Flash更加立体、更加精巧，canvas游戏在流畅度和跨平台方面更牛。<br><a href="http://www.oschina.net/news/20143/top-25-best-html5-canvas-games-you-love-to-play" target="_blank" rel="noopener">25 超棒的 HTML5 Canvas 游戏</a></li>
<li><strong>可视化数据</strong>.数据图表话，比如:<a href="http://echarts.baidu.com/" target="_blank" rel="noopener">百度的echart</a>    </li>
<li><strong>banner广告</strong>：Flash曾经辉煌的时代，智能手机还未曾出现。现在以及未来的智能机时代，HTML5技术能够在banner广告上发挥巨大作用，用Canvas实现动态的广告效果再合适不过。</li>
<li>未来=&gt; 模拟器：无论从视觉效果还是核心功能方面来说，模拟器产品可以完全由JavaScript来实现。</li>
<li>未来=&gt; 远程计算机控制：Canvas可以让开发者更好地实现基于Web的数据传输，构建一个完美的可视化控制界面。</li>
<li>未来=&gt; 图形编辑器：Photoshop图形编辑器将能够100%基于Web实现。</li>
<li>其他可嵌入网站的内容(多用于活动页面、特效)：类似图表、音频、视频，还有许多元素能够更好地与Web融合，并且不需要任何插件。</li>
<li><strong>完整的canvas移动化应用</strong></li>
<li>我们课程的目标<ul>
<li>我们不是主要做游戏开发的</li>
<li>要求必须会做基本的用canvas绘制的特效页面：比如，传智前端官网。</li>
<li>会用canvas做一些简单的广告、活动页面</li>
</ul>
</li>
<li>我们课程的案例和项目演示</li>
<li>canvas的标准： <ul>
<li>最新标准：<a href="http://www.w3.org/TR/2dcontext/" target="_blank" rel="noopener">http://www.w3.org/TR/2dcontext/</a></li>
<li>稳定版本的标准：<a href="http://www.w3.org/TR/2013/CR-2dcontext-20130806/" target="_blank" rel="noopener">http://www.w3.org/TR/2013/CR-2dcontext-20130806/</a></li>
<li>目前来说，标准还在完善中。先用早期的api足够完成所有的应用</li>
</ul>
</li>
</ol>
<h1 id="canvas绘图基础"><a href="#canvas绘图基础" class="headerlink" title="canvas绘图基础"></a>canvas绘图基础</h1><h2 id="sublime配置canvas插件（推荐）"><a href="#sublime配置canvas插件（推荐）" class="headerlink" title="sublime配置canvas插件（推荐）"></a>sublime配置canvas插件（推荐）</h2><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">推荐：</span><br><span class="line">    安装插件：AndyJS2</span><br><span class="line">    github地址： https://github.com/malun666/AndyJS2</span><br><span class="line">    直接下载到：X:<span class="symbol">\U</span>sers<span class="symbol">\用</span>户名<span class="symbol">\A</span>ppData<span class="symbol">\R</span>oaming<span class="symbol">\S</span>ublime Text 3<span class="symbol">\P</span>ackages</span><br></pre></td></tr></table></figure>
<h2 id="Canvas标签"><a href="#Canvas标签" class="headerlink" title="Canvas标签"></a>Canvas标签</h2><h3 id="canvas标签语法和属性-（重点）"><a href="#canvas标签语法和属性-（重点）" class="headerlink" title="canvas标签语法和属性  （重点）"></a>canvas标签语法和属性  （重点）</h3><ul>
<li>canvas：画布油布的意思 ==英 [‘kænvəs]   美 [‘kænvəs] ==</li>
<li>标签名canvas，需要进行闭合。就是一普通的html标签。</li>
<li>可以设置width和height属性，但是属性值<strong>单位必须是px</strong>，否则忽略。</li>
<li>width和hegiht：默认300*150像素</li>
<li>注意：<ul>
<li>不要用CSS控制它的宽和高,会走出图片拉伸，</li>
<li>重新设置canvas标签的宽高属性会让画布擦除所有的内容。</li>
<li>可以给canvas画布设置背景色</li>
</ul>
</li>
</ul>
<h3 id="浏览器不兼容处理（重点）"><a href="#浏览器不兼容处理（重点）" class="headerlink" title="浏览器不兼容处理（重点）"></a>浏览器不兼容处理（重点）</h3><ul>
<li>ie9以上才支持canvas, 其他chrome、ff、苹果浏览器等都支持</li>
<li>只要浏览器兼容canvas，那么就会支持绝大部分api(个别最新api除外)</li>
<li>移动端的兼容情况非常理想，基本上随便使用</li>
<li>2d的支持的都非常好，3d（webgl）ie11才支持，其他都支持</li>
<li>如果浏览器不兼容，最好进行友好提示         </li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">例如：                     </span><br><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"cavsElem"</span>&gt;</span></span><br><span class="line">    你的浏览器不支持canvas，请升级浏览器.浏览器不支持，显示此行文本</span><br><span class="line"><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>浏览器不兼容，可以使用<em>flash</em>等手段进行<strong>优雅降级</strong></li>
</ul>
<h2 id="canvas绘图上下文context"><a href="#canvas绘图上下文context" class="headerlink" title="canvas绘图上下文context"></a>canvas绘图上下文context</h2><h3 id="Context：Canvas的上下文、绘制环境。（重点掌握）"><a href="#Context：Canvas的上下文、绘制环境。（重点掌握）" class="headerlink" title="Context：Canvas的上下文、绘制环境。（重点掌握）"></a>Context：Canvas的上下文、绘制环境。（重点掌握）</h3><ul>
<li>上下文：上知天文，下知地理。是所有的绘制操作api的入口或者集合。</li>
<li>Canvas自身无法绘制任何内容。Canvas的绘图是使用JavaScript操作的。</li>
<li>Context对象就是JavaScript操作Canvas的接口。<br>*使用[CanvasElement].getContext(‘2d’)来获取2D绘图上下文。        </li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas  = <span class="built_in">document</span>.getElementById( <span class="string">'cavsElem'</span> ); <span class="comment">//获得画布</span></span><br><span class="line"><span class="keyword">var</span> ctx = canvas.getContext( <span class="string">'2d'</span> );<span class="comment">//注意：2d小写， 3d：webgl</span></span><br></pre></td></tr></table></figure>
<h2 id="基本的绘制路径（重点）"><a href="#基本的绘制路径（重点）" class="headerlink" title="基本的绘制路径（重点）"></a>基本的绘制路径（重点）</h2><h3 id="canvas坐标系"><a href="#canvas坐标系" class="headerlink" title="canvas坐标系"></a>canvas坐标系</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">canvas坐标系，从最左上角<span class="number">0</span>,<span class="number">0</span>开始。x向右增大， y向下增大</span><br></pre></td></tr></table></figure>
<p><img src="/2019-05-11/canvas/canvas-x-y.png" alt="canvas-x-y"></p>
<h3 id="设置绘制起点-moveTo"><a href="#设置绘制起点-moveTo" class="headerlink" title="设置绘制起点(moveTo)"></a>设置绘制起点(moveTo)</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>语法：ctx.moveTo(x, y); </span><br><span class="line"><span class="bullet">* </span>解释：设置上下文绘制路径的起点。相当于移动画笔到某个位置</span><br><span class="line"><span class="bullet">* </span>参数：x,y 都是相对于 canvas盒子的最左上角。</span><br><span class="line"><span class="bullet">* </span>注意：*<span class="strong">*绘制线段前必须先设置起点，不然绘制无效。*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure>
<h3 id="绘制直线-lineTo"><a href="#绘制直线-lineTo" class="headerlink" title="绘制直线(lineTo)"></a>绘制直线(lineTo)</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>语法：ctx.lineTo(x, y);</span><br><span class="line"><span class="bullet">* </span>解释：从x,y的位置绘制一条直线到起点或者上一个线头点。</span><br><span class="line"><span class="bullet">* </span>参数：x,y 线头点坐标。</span><br></pre></td></tr></table></figure>
<h3 id="路径开始和闭合"><a href="#路径开始和闭合" class="headerlink" title="路径开始和闭合"></a>路径开始和闭合</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>开始路径：ctx.beginPath();</span><br><span class="line"><span class="bullet">* </span>闭合路径：ctx.closePath();</span><br><span class="line"><span class="bullet">* </span>解释：如果复杂路径绘制，必须使用路径开始和结束。闭合路径会自动把最后的线头和开始的线头连在一起。</span><br><span class="line"><span class="bullet">* </span>beginPath: 核心的作用是将 不同绘制的形状进行隔离，</span><br><span class="line"><span class="code">  每次执行此方法，表示重新绘制一个路径,跟之前的绘制的墨迹可以进行分开样式设置和管理。</span></span><br></pre></td></tr></table></figure>
<h3 id="描边-stroke"><a href="#描边-stroke" class="headerlink" title="描边(stroke)"></a>描边(stroke)</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 语法：ctx.<span class="keyword">stroke();</span></span><br><span class="line"><span class="keyword">* </span>解释：根据路径绘制线。路径只是草稿，真正绘制线必须执行<span class="keyword">stroke</span></span><br><span class="line"><span class="keyword">* </span><span class="keyword">stroke: </span>（用笔等）画；轻抚；轻挪；敲击；划尾桨；划掉；（打字时）击打键盘</span><br><span class="line"> 英 [<span class="keyword">strəʊk] </span>  美 [<span class="keyword">strok]</span></span><br></pre></td></tr></table></figure>
<ul>
<li>canvas绘制的基本步骤：<ul>
<li>第一步：获得上下文 =&gt;canvasElem.getContext(‘2d’);</li>
<li>第二步：开始路径规划 =&gt;ctx.beginPath()</li>
<li>第三步：移动起始点 =&gt;ctx.moveTo(x, y)</li>
<li>第四步：绘制线(矩形、圆形、图片…) =&gt;ctx.lineTo(x, y)</li>
<li>第五步：闭合路径 =&gt;ctx.closePath();</li>
<li>第六步：绘制描边 =&gt;ctx.stroke();</li>
</ul>
</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">html部分：</span><br><span class="line">    &lt;canvas id=<span class="string">"cavsElem"</span>&gt;</span><br><span class="line">        你的浏览器不支持canvas，请升级浏览器</span><br><span class="line">    &lt;/canvas&gt;</span><br><span class="line"></span><br><span class="line">javascript部分：</span><br><span class="line"></span><br><span class="line"><span class="comment">//===============基本绘制api====================</span></span><br><span class="line"><span class="comment">//获得画布</span></span><br><span class="line">var canvas = document.querySelector('#cavsElem');</span><br><span class="line">var ctx = canvas.getContext('<span class="number">2</span>d');  <span class="comment">//获得上下文</span></span><br><span class="line"></span><br><span class="line">canvas.width = <span class="number">900</span>;     <span class="comment">//设置标签的属性宽高</span></span><br><span class="line">canvas.height = <span class="number">600</span>;    <span class="comment">//千万不要用 canvas.style.height</span></span><br><span class="line">canvas.style.border = <span class="string">"1px solid #000"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制三角形</span></span><br><span class="line">ctx.beginPath();        <span class="comment">//开始路径</span></span><br><span class="line">ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);    <span class="comment">//三角形，左顶点</span></span><br><span class="line">ctx.lineTo(<span class="number">300</span>, <span class="number">100</span>);   <span class="comment">//右顶点</span></span><br><span class="line">ctx.lineTo(<span class="number">300</span>, <span class="number">300</span>);   <span class="comment">//底部的点</span></span><br><span class="line">ctx.closePath();        <span class="comment">//结束路径</span></span><br><span class="line">ctx.stroke();           <span class="comment">//描边路径</span></span><br></pre></td></tr></table></figure>
<ul>
<li>综合案例：02绘制定位表格.html</li>
<li>综合案例：03画画板.html</li>
</ul>
<h3 id="填充-fill"><a href="#填充-fill" class="headerlink" title="填充(fill)"></a>填充(fill)</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>语法：ctx.fill(); </span><br><span class="line"><span class="bullet">* </span>解释：填充，是将闭合的路径的内容填充具体的颜色。默认黑色。</span><br></pre></td></tr></table></figure>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">* 注意：交叉路径的填充问题，“非零环绕原则”，顺逆时针穿插次数决定是否填充。</span><br><span class="line">    </span><br><span class="line">    以下是非<span class="number">0</span>环绕原则的原理：（了解即可，非常少会用到复杂的路径）</span><br><span class="line">    “非零环绕规则”是这么来判断有自我交叉情况的路径的：对于路径中的任意给定区域，从该区域内部画一条足够长的线段，</span><br><span class="line">    使此线段的终点完全落在路径范围之外。</span><br><span class="line">    图<span class="number">2</span><span class="number">-14</span>中的那三个箭头所描述的就是上面这个步骤。</span><br><span class="line">    接下来，将计数器初始化为<span class="number">0</span>，</span><br><span class="line">    然后，每当这条线段与路径上的直线或曲线相交时，</span><br><span class="line">    就改变计数器的值。如果是与路径的顺时针部分相交，则加<span class="number">1</span>，</span><br><span class="line">    如果是与路径的逆时针部分相交，则减<span class="number">1</span>。若计数器的最终值不是<span class="number">0</span>，那么此区域就在路径里面，在调用fill()方法时，</span><br><span class="line">    浏览器就会对其进行填充。</span><br><span class="line">    如果最终值是<span class="number">0</span>，那么此区域就不在路径内部，浏览器也就不会对其进行填充了</span><br><span class="line">* 案例： <span class="number">04</span>填充矩形.html</span><br></pre></td></tr></table></figure>
<p><img src="/2019-05-11/canvas/fill-0-prin.jpg" alt="fill-0-prin"></p>
<h3 id="快速创建矩形rect-方法"><a href="#快速创建矩形rect-方法" class="headerlink" title="快速创建矩形rect()方法"></a>快速创建矩形rect()方法</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 语法：ctx.<span class="built_in">rect</span>(x, y, <span class="built_in">width</span>, <span class="built_in">height</span>);</span><br><span class="line">* 解释：x, y是矩形左上角坐标， <span class="built_in">width</span>和<span class="built_in">height</span>都是以像素计</span><br><span class="line">* <span class="built_in">rect</span>方法只是规划了矩形的路径，并没有填充和描边。</span><br><span class="line">* 改造案例：<span class="number">04</span>填充矩形.html</span><br><span class="line">*<span class="built_in">rect</span>: abbr. 矩形（rectangular）；收据（receipt）</span><br></pre></td></tr></table></figure>
<h3 id="快速创建描边矩形和填充矩形"><a href="#快速创建描边矩形和填充矩形" class="headerlink" title="快速创建描边矩形和填充矩形"></a>快速创建描边矩形和填充矩形</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 语法： ctx.strokeRect(x, y, <span class="built_in">width</span>, <span class="built_in">height</span>);</span><br><span class="line">    - 参数跟<span class="number">2.3</span><span class="number">.8</span>相同，注意此方法绘制完路径后立即进行<span class="built_in">stroke</span>绘制</span><br><span class="line">* 语法：ctx.fillRect(x, y, <span class="built_in">width</span>, <span class="built_in">height</span>);</span><br><span class="line">    - 参数跟<span class="number">2.3</span><span class="number">.8</span>相同， 此方法执行完成后。立即对当前矩形进行<span class="built_in">fill</span>填充。</span><br></pre></td></tr></table></figure>
<h3 id="清除矩形-clearRect"><a href="#清除矩形-clearRect" class="headerlink" title="清除矩形(clearRect)"></a>清除矩形(clearRect)</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>语法：ctx.clearRect(x, y, width, hegiht);</span><br><span class="line"><span class="bullet">* </span>解释：清除某个矩形内的绘制的内容，相当于橡皮擦。</span><br></pre></td></tr></table></figure>
<h2 id="绘制圆形（arc"><a href="#绘制圆形（arc" class="headerlink" title="绘制圆形（arc)"></a>绘制圆形（arc)</h2><ul>
<li>概述：arc() 方法创建弧/曲线（用于创建圆或部分圆）。<ul>
<li>语法：ctx.arc(x,y,r,sAngle,eAngle,counterclockwise);</li>
<li>arc:  弧（度）弧形物；天穹 英 [ɑːk]   美 [ɑrk]</li>
<li>counter 反击，还击；反向移动，对着干；反驳，回答  [‘kaʊntə]   美 [‘kaʊntɚ]</li>
<li>解释：<ul>
<li>x,y：圆心坐标。 </li>
<li>r：半径大小。</li>
<li>sAngle:绘制开始的角度。 圆心到最右边点是0度，顺时针方向弧度增大。</li>
<li>eAngel:结束的角度，注意是弧度。π</li>
<li>counterclockwise：是否是逆时针。true是逆时针，false：顺时针</li>
<li>弧度和角度的转换公式： rad = deg*Math.PI/180;  </li>
<li>在Math提供的方法中<strong>sin、cos等都使用的弧度</strong><br> <img src="/2019-05-11/canvas/arc.gif" alt="arc">  </li>
</ul>
</li>
</ul>
</li>
<li>案例：05绘制圆形.html</li>
<li>案例：06绘制饼状图.html</li>
</ul>
<h2 id="绘制文字（会使用就可以了）"><a href="#绘制文字（会使用就可以了）" class="headerlink" title="绘制文字（会使用就可以了）"></a>绘制文字（会使用就可以了）</h2><h3 id="绘制上下文的文字属性-（有印象就行了）"><a href="#绘制上下文的文字属性-（有印象就行了）" class="headerlink" title="绘制上下文的文字属性 （有印象就行了）"></a>绘制上下文的文字属性 （有印象就行了）</h3><ul>
<li>font            设置或返回文本内容的当前字体属性<ul>
<li>font 属性使用的语法与 CSS font 属性相同。</li>
</ul>
</li>
</ul>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例如：ctx.font = <span class="string">"18px '微软雅黑'"</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>textAlign       设置或返回文本内容的当前对齐方式<ul>
<li>start :    默认。文本在指定的位置开始。</li>
<li>end   :    文本在指定的位置结束。</li>
<li>center:    文本的中心被放置在指定的位置。</li>
<li>left  :    文本左对齐。</li>
<li>right :    文本右对齐。      </li>
</ul>
</li>
</ul>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* 例如：ctx.<span class="built_in">textAlign</span> = <span class="string">'left'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/2019-05-11/canvas/textAsign.png" alt="textAsign"></p>
<ul>
<li>textBaseline      设置或返回在绘制文本时使用的当前文本基线   <ul>
<li>alphabetic ：   默认。文本基线是普通的字母基线。</li>
<li>top        ：   文本基线是 em 方框的顶端。。</li>
<li>hanging    ：   文本基线是悬挂基线。</li>
<li>middle     ：   文本基线是 em 方框的正中。</li>
<li>ideographic：   文本基线是em基线。</li>
<li>bottom     ：   文本基线是 em 方框的底端。     </li>
</ul>
</li>
</ul>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">例如： ctx.textBaseline = 'top';</span><br><span class="line">单词:</span><br><span class="line"> alphabetic: 字母的；照字母次序的   <span class="string">[,ælfə'bɛtɪk]</span></span><br><span class="line"> ideographic：表意的；表意字构成的   英 <span class="string">[,ɪdɪəʊ'ɡræfɪk]</span>   美 <span class="string">[,ɪdɪə'græfɪk]</span></span><br></pre></td></tr></table></figure>
<p>​     <img src="/2019-05-11/canvas/font-line1.png" alt="font-line1"><br>  <img src="/2019-05-11/canvas/textBaseline.gif" alt="textBaseline"></p>
<h3 id="上下文绘制文字方法"><a href="#上下文绘制文字方法" class="headerlink" title="上下文绘制文字方法"></a>上下文绘制文字方法</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* <span class="selector-tag">ctx</span><span class="selector-class">.fillText</span>()      在画布上绘制“被填充的”文本</span><br><span class="line">* <span class="selector-tag">ctx</span><span class="selector-class">.strokeText</span>()    在画布上绘制文本（无填充）</span><br><span class="line">* <span class="selector-tag">ctx</span><span class="selector-class">.measureText</span>()   返回包含指定文本宽度的对象</span><br><span class="line">* 单词：<span class="selector-tag">measure</span> 测量；估量；权衡   英 <span class="selector-attr">['meʒə]</span>   美 <span class="selector-attr">['mɛʒɚ]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//综合案例代码：</span></span><br><span class="line">ctx.moveTo( <span class="number">300</span>, <span class="number">300</span> );</span><br><span class="line">ctx.fillStyle = <span class="string">"purple"</span>;               <span class="comment">//设置填充颜色为紫色</span></span><br><span class="line">ctx.font = '<span class="number">20</span>px <span class="string">"微软雅黑"</span>';           <span class="comment">//设置字体</span></span><br><span class="line">ctx.textBaseline = <span class="string">"bottom"</span>;            <span class="comment">//设置字体底线对齐绘制基线</span></span><br><span class="line">ctx.textAlign = <span class="string">"left"</span>;                 <span class="comment">//设置字体对齐的方式</span></span><br><span class="line"><span class="comment">//ctx.strokeText( "left", 450, 400 );</span></span><br><span class="line">ctx.fillText( <span class="string">"Top-g"</span>, <span class="number">100</span>, <span class="number">300</span> );        <span class="comment">//填充文字</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="绘制图片（drawImage）-（重点）"><a href="#绘制图片（drawImage）-（重点）" class="headerlink" title="绘制图片（drawImage）  （重点）"></a>绘制图片（drawImage）  （重点）</h2><h3 id="基本绘制图片的方式"><a href="#基本绘制图片的方式" class="headerlink" title="基本绘制图片的方式"></a>基本绘制图片的方式</h3><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">context.drawImage(img,<span class="keyword">x</span>,y)<span class="comment">;</span></span><br><span class="line"><span class="comment">参数说明： x,y 绘制图片左上角的坐标， img是绘制图片的dom对象。</span></span><br></pre></td></tr></table></figure>
<h3 id="在画布上绘制图像，并规定图像的宽度和高度"><a href="#在画布上绘制图像，并规定图像的宽度和高度" class="headerlink" title="在画布上绘制图像，并规定图像的宽度和高度"></a>在画布上绘制图像，并规定图像的宽度和高度</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">context.drawImage(img,x,y,<span class="built_in">width</span>,<span class="built_in">height</span>);   </span><br><span class="line">参数说明：<span class="built_in">width</span> 绘制图片的宽度，  <span class="built_in">height</span>：绘制图片的高度</span><br><span class="line">如果指定宽高，最好成比例，不然图片会被拉伸&lt;/em&gt;</span><br><span class="line">    等比公式：  toH = Height * toW   /  Width;  <span class="comment">//等比 </span></span><br><span class="line">             设置高 = 原高度 * 设置宽/ 原宽度;</span><br></pre></td></tr></table></figure>
<h3 id="图片裁剪，并在画布上定位被剪切的部分"><a href="#图片裁剪，并在画布上定位被剪切的部分" class="headerlink" title="图片裁剪，并在画布上定位被剪切的部分"></a>图片裁剪，并在画布上定位被剪切的部分</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">context</span>.drawImage(img,sx,sy,<span class="keyword">swidth,sheight,x,y,width,height);</span></span><br><span class="line"><span class="keyword">参数说明：</span></span><br><span class="line"><span class="keyword"> </span>   sx,sy 裁剪的左上角坐标，</span><br><span class="line">    <span class="keyword">swidth：裁剪图片的高度。 </span><span class="keyword">sheight:裁剪的高度 </span></span><br><span class="line">    其他同上</span><br></pre></td></tr></table></figure>
<h3 id="用JavaScript创建img对象"><a href="#用JavaScript创建img对象" class="headerlink" title="用JavaScript创建img对象"></a>用JavaScript创建img对象</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">第一种方式： </span><br><span class="line">   <span class="keyword">var</span> img = <span class="built_in">document</span>.getElementById(<span class="string">"imgId"</span>);</span><br><span class="line">第二种方式：</span><br><span class="line">    <span class="keyword">var</span> img = <span class="keyword">new</span> Image();<span class="comment">//这个就是 img标签的dom对象</span></span><br><span class="line">    img.src = <span class="string">"imgs/arc.gif"</span>;</span><br><span class="line">    img.alt = <span class="string">"文本信息"</span>;</span><br><span class="line">    img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//图片加载完成后，执行此方法</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="面向对象基础复习补充："><a href="#面向对象基础复习补充：" class="headerlink" title="面向对象基础复习补充："></a>面向对象基础复习补充：</h3><ul>
<li>创建对象的方式：</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* <span class="keyword">var</span> o = &#123; name: <span class="string">'123'</span>, age: <span class="number">18</span> &#125;; <span class="comment">//json方式创建</span></span><br><span class="line">* <span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>();  <span class="comment">//通过new的方式创建</span></span><br><span class="line">* <span class="keyword">var</span> o = <span class="keyword">new</span> Persion(); <span class="comment">//通过类的构造函数创建</span></span><br></pre></td></tr></table></figure>
<ul>
<li>JS中对象的属性创建方式</li>
</ul>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>json的方式： var o = &#123; age: 19 &#125;;</span><br><span class="line"><span class="bullet">* </span>直接添加属性：var o = &#123;&#125;;  o.age = 19;//太分散了，不利于管理</span><br><span class="line"><span class="bullet">* </span>由于js动态语言的特性，如果属性不存在的时候，直接添加属性。</span><br><span class="line"><span class="bullet">* </span>构造函数添加属性</span><br><span class="line"><span class="bullet">* </span>原型添加公共的属性</span><br></pre></td></tr></table></figure>
<ul>
<li>JS的构造函数的原型<br>构造函数的原型就是：构造对象的模板，构造函数原型里面的所有的属性和方法都会共享给所有的 构造函数构造出来的所有实例。<br><img src="/2019-05-11/canvas/prototype.png" alt="prototype"></li>
<li>案例： 08绘制图片.html</li>
<li>案例： 09绘制图片裁剪.html</li>
<li>案例： 10序列帧动画.html</li>
<li>案例： 11面向对象版本的动画帧.html  <strong>重点</strong></li>
</ul>
<h2 id="补充-sublime制作代码段（推荐–已结讲过了）"><a href="#补充-sublime制作代码段（推荐–已结讲过了）" class="headerlink" title="补充 sublime制作代码段（推荐–已结讲过了）"></a>补充 sublime制作代码段（推荐–已结讲过了）</h2><p>第一步：sublime菜单栏→ 工具 → 制作代码段 </p>
<p>第二步：修改输出的sublime代码段文本</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">snippet</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">content</span>&gt;</span>&lt;![CDATA[</span></span><br><span class="line"><span class="xml">1、这里放要tab键 输出的内容</span></span><br><span class="line"><span class="xml">2、 $</span><span class="template-variable">&#123;1:this&#125;</span><span class="xml"> 占位符，tab可以进行切换，数字是切换的索引。</span></span><br><span class="line"><span class="xml">    ：后面的是默认的文本。</span></span><br><span class="line"><span class="xml">]]&gt;<span class="tag">&lt;/<span class="name">content</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- Optional: Set a tabTrigger to define how to trigger the snippet --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">tabTrigger</span>&gt;</span>简写的字母<span class="tag">&lt;/<span class="name">tabTrigger</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- Optional: Set a scope to limit where the snippet will trigger --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- &lt;scope&gt;source.python&lt;/scope&gt; --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">snippet</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>第三步：保存到插件的文件夹中，后缀名为：.sublime-snippet<br>比如我存放的位置：<br> C:\Users\malunmac\AppData\Roaming\Sublime Text 3\Packages\User\snippets<br><strong>snippets是我自己新建的文件夹。</strong></p>
<hr>
<h1 id="canvas进阶"><a href="#canvas进阶" class="headerlink" title="canvas进阶"></a>canvas进阶</h1><h2 id="Canvas颜色样式和阴影"><a href="#Canvas颜色样式和阴影" class="headerlink" title="Canvas颜色样式和阴影"></a>Canvas颜色样式和阴影</h2><h3 id="设置填充和描边的颜色（掌握）"><a href="#设置填充和描边的颜色（掌握）" class="headerlink" title="设置填充和描边的颜色（掌握）"></a>设置填充和描边的颜色（掌握）</h3><ul>
<li>fillStyle  : 设置或返回用于填充绘画的颜色</li>
<li>strokeStyle: 设置或返回用于笔触的颜色</li>
</ul>
<p>以上两个值都可以接受颜色名,16进制数据，rgb值，甚至rgba.<br>一般先进行设置样式然后进行绘制。</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">例如：</span><br><span class="line">ctx.strokeStyle = <span class="string">"red"</span><span class="comment">;      </span></span><br><span class="line">ctx.strokeStyle = <span class="string">"#ccc"</span><span class="comment">;      </span></span><br><span class="line">ctx.strokeStyle = <span class="string">"rgb(255,0,0)"</span><span class="comment">;      </span></span><br><span class="line">ctx.strokeStyle = <span class="string">"rgba(255,0,0,6)"</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<h3 id="设置阴影（了解，少用，性能差）"><a href="#设置阴影（了解，少用，性能差）" class="headerlink" title="设置阴影（了解，少用，性能差）"></a>设置阴影（了解，少用，性能差）</h3><ul>
<li>类比于CSS3的阴影。</li>
<li>shadowColor  ：   设置或返回用于阴影的颜色</li>
<li>shadowBlur   ：   设置或返回用于阴影的模糊级别,大于1的正整数，数值越高，模糊程度越大</li>
<li>shadowOffsetX：   设置或返回阴影距形状的水平距离</li>
<li>shadowOffsetY：   设置或返回阴影距形状的垂直距离</li>
</ul>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ctx.fillStyle = <span class="string">"rgba(255,0,0, .9)"</span></span><br><span class="line">ctx.<span class="keyword">shadowColor </span>= <span class="string">"teal"</span><span class="comment">;</span></span><br><span class="line">ctx.<span class="keyword">shadowBlur </span>= <span class="number">10</span><span class="comment">;</span></span><br><span class="line">ctx.<span class="keyword">shadowOffsetX </span>= <span class="number">10</span><span class="comment">;</span></span><br><span class="line">ctx.<span class="keyword">shadowOffsetY </span>= <span class="number">10</span><span class="comment">;</span></span><br><span class="line">ctx.fillRect(<span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>例如：</p>
<ul>
<li>案例： 12设置box盒子阴影.html</li>
<li>设置png图片的阴影，图片透明部分不会被投影。</li>
</ul>
<h2 id="复杂样式（了解）"><a href="#复杂样式（了解）" class="headerlink" title="复杂样式（了解）"></a>复杂样式（了解）</h2><h3 id="创建线性渐变的样式（了解）"><a href="#创建线性渐变的样式（了解）" class="headerlink" title="创建线性渐变的样式（了解）"></a>创建线性渐变的样式（了解）</h3><ul>
<li>一般不用，都是用图片代替，canvas绘制图片效率更高。</li>
<li>线性渐变可以用于 矩形、圆形、文字等颜色样式</li>
<li>线性渐变是一个对象</li>
<li>语法：ctx.createLinearGradient(x0,y0,x1,y1); //参数：x0,y0起始坐标，x1,y1结束坐标</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">例如：</span><br><span class="line"><span class="comment">//创建线性渐变的对象，</span></span><br><span class="line">var grd=ctx.createLinearGradient(<span class="number">0</span>,<span class="number">0</span>,<span class="number">170</span>,<span class="number">0</span>);</span><br><span class="line">grd.addColorStop(<span class="number">0</span>,<span class="string">"black"</span>);  <span class="comment">//添加一个渐变颜色，第一个参数介于 0.0 与 1.0 之间的值，表示渐变中开始与结束之间的位置。</span></span><br><span class="line">grd.addColorStop(<span class="number">1</span>,<span class="string">"white"</span>);  <span class="comment">//添加一个渐变颜色</span></span><br><span class="line">ctx.fillStyle =grd;           <span class="comment">//关键点，把渐变设置到 填充的样式</span></span><br></pre></td></tr></table></figure>
<p>案例13设置线性渐变.html</p>
<h3 id="设置圆形渐变（径向渐变）-了解"><a href="#设置圆形渐变（径向渐变）-了解" class="headerlink" title="设置圆形渐变（径向渐变） 了解"></a>设置圆形渐变（径向渐变） 了解</h3><ul>
<li>创建放射状/圆形渐变对象。可以填充文本、形状等</li>
<li>context.createRadialGradient(x0,y0,r0,x1,y1,r1);</li>
<li>radial   半径的；放射状的；光线的；光线状的   英 [‘reɪdɪəl]   美 [‘redɪəl]</li>
<li>参数详解：<ul>
<li>x0:  渐变的开始圆的 x 坐标</li>
<li>y0:  渐变的开始圆的 y 坐标</li>
<li>r0:  开始圆的半径</li>
<li>x1:  渐变的结束圆的 x 坐标</li>
<li>y1:  渐变的结束圆的 y 坐标</li>
<li>r1:  结束圆的半径</li>
</ul>
</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var rlg = ctx.createRadialGradient(<span class="number">300</span>,<span class="number">300</span>,<span class="number">10</span>,<span class="number">300</span>,<span class="number">300</span>,<span class="number">200</span>);</span><br><span class="line">rlg.addColorStop(<span class="number">0</span>, 'teal');    <span class="comment">//添加一个渐变颜色</span></span><br><span class="line">rlg.addColorStop(<span class="number">.4</span>, 'navy');</span><br><span class="line">rlg.addColorStop(<span class="number">1</span>, 'purple');</span><br><span class="line">ctx.fillStyle = rlg;<span class="comment">//设置 填充样式为延续渐变的样式</span></span><br><span class="line">ctx.fillRect(<span class="number">100</span>, <span class="number">100</span>, <span class="number">500</span>, <span class="number">500</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>案例14圆形渐变.html</li>
</ul>
<h3 id="绘制背景图（了解）"><a href="#绘制背景图（了解）" class="headerlink" title="绘制背景图（了解）"></a>绘制背景图（了解）</h3><ul>
<li>ctx.createPattern(img,repeat) 方法在指定的方向内重复指定的元素了解</li>
<li>pattern：n. 模式；图案；样品  英 [‘pæt(ə)n]   美 [‘pætɚn]</li>
<li>第一参数：设置平铺背景的图片，第二个背景平铺的方式。<ul>
<li>image    ：   规定要使用的图片、画布或视频元素。</li>
<li>repeat   ：   默认。该模式在水平和垂直方向重复。</li>
<li>repeat-x ：   该模式只在水平方向重复。</li>
<li>repeat-y ：   该模式只在垂直方向重复。</li>
<li>no-repeat：   该模式只显示一次（不重复）。</li>
</ul>
</li>
</ul>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var ctx=c.getContext(<span class="string">"2d"</span>)<span class="comment">;</span></span><br><span class="line">var img=document.getElementById(<span class="string">"lamp"</span>)<span class="comment">;</span></span><br><span class="line">var pat=ctx.createPattern(img,<span class="string">"repeat"</span>)<span class="comment">;</span></span><br><span class="line">ctx.rect(<span class="number">0</span>,<span class="number">0</span>,<span class="number">150</span>,<span class="number">100</span>)<span class="comment">;</span></span><br><span class="line">ctx.fillStyle=pat<span class="comment">;//  把背景图设置给填充的样式</span></span><br><span class="line">ctx.fill()<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>案例15背景图填充.html</li>
</ul>
<h2 id="变换（重点）"><a href="#变换（重点）" class="headerlink" title="变换（重点）"></a>变换（重点）</h2><h3 id="缩放（重点）"><a href="#缩放（重点）" class="headerlink" title="缩放（重点）"></a>缩放（重点）</h3><ul>
<li>scale() 方法缩放当前绘图，更大或更小</li>
<li>语法：context.scale(scalewidth,scaleheight)<ul>
<li>scalewidth  :  缩放当前绘图的宽度 (1=100%, 0.5=50%, 2=200%, 依次类推)</li>
<li>scaleheight :  缩放当前绘图的高度 (1=100%, 0.5=50%, 2=200%, etc.)<br>+注意：缩放的是整个画布，缩放后，继续绘制的图形会被放大或缩小。</li>
</ul>
</li>
<li>案例16缩放案例.html</li>
</ul>
<h3 id="位移画布（重点）"><a href="#位移画布（重点）" class="headerlink" title="位移画布（重点）"></a>位移画布（重点）</h3><ul>
<li>ctx.translate(x,y) 方法重新映射画布上的 (0,0) 位置</li>
<li>参数说明：<ul>
<li>x：   添加到水平坐标（x）上的值</li>
<li>y：   添加到垂直坐标（y）上的值</li>
</ul>
</li>
<li>发生位移后，相当于把画布的0,0坐标 更换到新的x,y的位置，所有绘制的新元素都被影响。</li>
<li>位移画布一般配合缩放和旋转等。</li>
<li>案例： 17位移画布.html</li>
</ul>
<h3 id="旋转（重点）"><a href="#旋转（重点）" class="headerlink" title="旋转（重点）"></a>旋转（重点）</h3><ul>
<li>context.rotate(angle); 方法旋转当前的绘图</li>
<li>注意参数是弧度（PI）</li>
<li>如需将角度转换为弧度，请使用 degrees*Math.PI/180 公式进行计算。</li>
<li>案例：18旋转画布.html</li>
</ul>
<h2 id="绘制环境保存和还原（重要）"><a href="#绘制环境保存和还原（重要）" class="headerlink" title="绘制环境保存和还原（重要）"></a>绘制环境保存和还原（重要）</h2><ul>
<li>ctx.save()  保存当前环境的状态<ul>
<li>可以把当前绘制环境进行保存到缓存中。</li>
</ul>
</li>
<li>ctx.restore()   返回之前保存过的路径状态和属性<ul>
<li>获取最近缓存的ctx</li>
</ul>
</li>
<li>一般配合位移画布使用。</li>
<li>案例： 19矩形旋转案例.html</li>
</ul>
<h2 id="设置绘制环境的透明度（了解）"><a href="#设置绘制环境的透明度（了解）" class="headerlink" title="设置绘制环境的透明度（了解）"></a>设置绘制环境的透明度（了解）</h2><ul>
<li>context.globalAlpha=number;</li>
<li>number:透明值。必须介于 0.0（完全透明） 与 1.0（不透明） 之间。</li>
<li>设置透明度是全局的透明度的样式。注意是全局的。</li>
</ul>
<h2 id="画布限定区域绘制（了解）"><a href="#画布限定区域绘制（了解）" class="headerlink" title="画布限定区域绘制（了解）"></a>画布限定区域绘制（了解）</h2><ul>
<li>ctx.clip(); 方法从原始画布中剪切任意形状和尺寸</li>
<li>一旦剪切了某个区域，则所有之后的绘图都会被限制在被剪切的区域内（不能访问画布上的其他区域）</li>
<li>一般配合绘制环境的保存和还原。</li>
</ul>
<h2 id="画布保存base64编码内容（重要）"><a href="#画布保存base64编码内容（重要）" class="headerlink" title="画布保存base64编码内容（重要）"></a>画布保存base64编码内容（重要）</h2><ul>
<li>把canvas绘制的内容输出成base64内容。 </li>
<li>语法：canvas.toDataURL(type, encoderOptions);</li>
<li>例如：canvas.toDataURL(“image/jpg”,1);</li>
<li>参数说明：<ul>
<li>type，设置输出的类型，比如 image/png   image/jpeg等</li>
<li>encoderOptions： 0-1之间的数字，用于标识输出图片的质量，1表示无损压缩，类型为： image/jpeg 或者image/webp才起作用。</li>
</ul>
</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">案例<span class="number">1</span>：</span><br><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">"canvas"</span>);</span><br><span class="line"><span class="keyword">var</span> dataURL = canvas.toDataURL();</span><br><span class="line">console.log(dataURL);</span><br><span class="line"><span class="comment">// "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNby</span></span><br><span class="line"><span class="comment">// blAAAADElEQVQImWNgoBMAAABpAAFEI8ARAAAAAElFTkSuQmCC"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> img = <span class="built_in">document</span>.<span class="built_in">querySelector</span>(<span class="string">"#img-demo"</span>);<span class="comment">//拿到图片的dom对象</span></span><br><span class="line">img.src = canvas.toDataURL(<span class="string">"image/png"</span>);      <span class="comment">//将画布的内容给图片标签显示</span></span><br></pre></td></tr></table></figure>
<h2 id="画布渲染画布（重要）"><a href="#画布渲染画布（重要）" class="headerlink" title="画布渲染画布（重要）"></a>画布渲染画布（重要）</h2><ul>
<li>context.drawImage(img,x,y);</li>
<li>img参数也可以是画布，也就是把一个画布整体的渲染到另外一个画布上。</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas1 = <span class="built_in">document</span>.<span class="built_in">querySelector</span>(<span class="string">'#cavsElem1'</span>);</span><br><span class="line"><span class="keyword">var</span> canvas2 = <span class="built_in">document</span>.<span class="built_in">querySelector</span>(<span class="string">'#cavsElem2'</span>);</span><br><span class="line"><span class="keyword">var</span> ctx1 = canvas1.getContext(<span class="string">'2d'</span>);</span><br><span class="line"><span class="keyword">var</span> ctx2 = canvas2.getContext(<span class="string">'2d'</span>);</span><br><span class="line">ctx1.fillRect(<span class="number">20</span>, <span class="number">20</span>, <span class="number">40</span>, <span class="number">40</span>);      <span class="comment">//在第一个画布上绘制矩形</span></span><br><span class="line"></span><br><span class="line">ctx2.drawImage(canvas1, <span class="number">10</span>, <span class="number">10</span>);    <span class="comment">//将第一个画布整体绘制到第二个画布上</span></span><br></pre></td></tr></table></figure>
<h2 id="了解：线条样式（了解）"><a href="#了解：线条样式（了解）" class="headerlink" title="了解：线条样式（了解）"></a>了解：线条样式（了解）</h2><ul>
<li>lineCap     设置或返回线条的结束端点(线头、线冒)样式<ul>
<li>butt  ：  默认。向线条的每个末端添加平直的边缘。<ul>
<li>翻译.：屁股；烟头；笑柄；靶垛；粗大的一端  英 [bʌt]   美 [bʌt]</li>
</ul>
</li>
<li>round ：  向线条的每个末端添加圆形线帽。</li>
<li>square：  向线条的每个末端添加正方形线帽。<br>  <img src="/2019-05-11/canvas/linecap.png" alt="linecap"><br>参考：23线的样式.html</li>
</ul>
</li>
<li>lineJoin    设置或返回两条线相交时，所创建的拐角类型<ul>
<li>bevel:   创建斜角。<ul>
<li>翻译. 斜角；斜面；[测] 斜角规  英 [‘bev(ə)l]   美 [‘bɛvl]</li>
</ul>
</li>
<li>round:   创建圆角。</li>
<li>miter:   默认。创建尖角<br><img src="/2019-05-11/canvas/linejoin.png" alt="linejoin"></li>
</ul>
</li>
<li>lineWidth   设置或返回当前的线条宽度</li>
<li>miterLimit  设置或返回最大斜接长度<ul>
<li>意思:  斜接 英 [‘maɪtə]  </li>
<li>斜接长度指的是在两条线交汇处内角和外角之间的距离。</li>
<li>一般用默认值：10就可以了。除非需要特别长的尖角时，使用此属性。<br><img src="/2019-05-11/canvas/MiterLimet.png" alt="MiterLimet"></li>
</ul>
</li>
</ul>
<h2 id="了解贝塞尔曲线（知道有）"><a href="#了解贝塞尔曲线（知道有）" class="headerlink" title="了解贝塞尔曲线（知道有）"></a>了解贝塞尔曲线（知道有）</h2><h3 id="绘制一条二次方曲线。"><a href="#绘制一条二次方曲线。" class="headerlink" title="绘制一条二次方曲线。"></a>绘制一条二次方曲线。</h3><ul>
<li>微软的画图板中的曲线的颜色。</li>
<li>quadratic：二次方的意思， 英 [kwɒ’drætɪk]   美 [kwɑ’drætɪk]</li>
<li>Curve：曲线的意思， 英 [kɜːv]   美 [kɝv]</li>
<li>语法： context.quadraticCurveTo(cpx,cpy,x,y);</li>
<li>参数：<ul>
<li>cpx：   贝塞尔控制点的 x 坐标</li>
<li>cpy：   贝塞尔控制点的 y 坐标</li>
<li>x  ：   结束点的 x 坐标</li>
<li>y  ：   结束点的 y 坐标<br><img src="/2019-05-11/canvas/quadraticcurve.gif" alt="quadraticcurve"></li>
</ul>
</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(<span class="number">20</span>,<span class="number">20</span>);</span><br><span class="line"><span class="comment">//绘制2次方曲线，贝赛尔曲线</span></span><br><span class="line">ctx.quadraticCurveTo(<span class="number">20</span>,<span class="number">100</span>,<span class="number">200</span>,<span class="number">20</span>);</span><br><span class="line">ctx.stroke();</span><br></pre></td></tr></table></figure>
<h3 id="绘制贝塞尔曲线（知道有）"><a href="#绘制贝塞尔曲线（知道有）" class="headerlink" title="绘制贝塞尔曲线（知道有）"></a>绘制贝塞尔曲线（知道有）</h3><ul>
<li>绘制一条三次贝塞尔曲线</li>
<li>语法：context.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y);</li>
<li>提示：三次贝塞尔曲线需要三个点。前两个点是用于三次贝塞尔计算中的控制点，第三个点是曲线的结束点。曲线的开始点是当前路径中最后一个点。如果路径不存在，那么请使用 beginPath() 和 moveTo() 方法来定义开始点。</li>
<li>参数说明：<ul>
<li>cp1x：    第一个贝塞尔控制点的 x 坐标</li>
<li>cp1y：    第一个贝塞尔控制点的 y 坐标</li>
<li>cp2x：    第二个贝塞尔控制点的 x 坐标</li>
<li>cp2y：    第二个贝塞尔控制点的 y 坐标</li>
<li>x:        结束点的 x 坐标</li>
<li>y:        结束点的 y 坐标   </li>
</ul>
</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//绘制复杂的贝塞尔曲线</span></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(<span class="number">400</span>,<span class="number">400</span>);</span><br><span class="line"><span class="comment">//参数说明：context.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y);</span></span><br><span class="line"><span class="comment">// cp1x： 第一个贝塞尔控制点的 x 坐标</span></span><br><span class="line"><span class="comment">// cp1y： 第一个贝塞尔控制点的 y 坐标</span></span><br><span class="line"><span class="comment">// cp2x： 第二个贝塞尔控制点的 x 坐标</span></span><br><span class="line"><span class="comment">// cp2y： 第二个贝塞尔控制点的 y 坐标</span></span><br><span class="line"><span class="comment">// x: 结束点的 x 坐标</span></span><br><span class="line"><span class="comment">// y: 结束点的 y 坐标</span></span><br><span class="line">ctx.bezierCurveTo(<span class="number">500</span>, <span class="number">200</span>, <span class="number">600</span>, <span class="number">600</span>, <span class="number">700</span>, <span class="number">300</span>);</span><br><span class="line">ctx.stroke();</span><br></pre></td></tr></table></figure>
<ul>
<li>案例：25绘制贝塞尔曲线.html<br><img src="/2019-05-11/canvas/beziercurve.gif" alt="beziercurve"></li>
</ul>
<h2 id="了解创建两条切线的弧（知道有）"><a href="#了解创建两条切线的弧（知道有）" class="headerlink" title="了解创建两条切线的弧（知道有）"></a>了解创建两条切线的弧（知道有）</h2><ul>
<li>在画布上创建介于当前起点和两个点形成的夹角的切线之间的弧</li>
<li>语法： context.arcTo(x1,y1,x2,y2,r); //类比：css3中的圆角。</li>
<li>例如： ctx.arcTo(240, 100, 240, 110, 40);</li>
<li>参数：<ul>
<li>x1:  弧的端点1的 x 坐标</li>
<li>y1:  弧的端点1的 y 坐标</li>
<li>x2:  弧的端点2(终点)的 x 坐标</li>
<li>y2:  弧的端点2(终点)的 y 坐标</li>
<li>r :  弧的半径   </li>
</ul>
</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//代码demo：</span></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">ctx.lineTo(<span class="number">200</span>,<span class="number">100</span>);</span><br><span class="line"><span class="comment">//context.arcTo(x1,y1,x2,y2,r); //类比：css3中的圆角。</span></span><br><span class="line">ctx.arcTo(<span class="number">240</span>, <span class="number">100</span>, <span class="number">240</span>, <span class="number">110</span>, <span class="number">40</span>);</span><br><span class="line">ctx.lineTo(<span class="number">240</span>, <span class="number">300</span>);</span><br><span class="line">ctx.stroke();</span><br></pre></td></tr></table></figure>
<p><img src="/2019-05-11/canvas/canvas-arcto-1.png" alt="canvas-arcto-1"></p>
<h2 id="了解判断点是否在路径中（知道有）"><a href="#了解判断点是否在路径中（知道有）" class="headerlink" title="了解判断点是否在路径中（知道有）"></a>了解判断点是否在路径中（知道有）</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">context.isPointInPath<span class="params">(x,y)</span>;</span><br><span class="line"><span class="string">//isPointInPath</span><span class="params">()</span> 方法返回 <span class="literal">true</span>，如果指定的点位于当前路径中；否则返回 <span class="literal">false</span>。</span><br><span class="line"><span class="string">//</span>判断x,y坐标的点是否在当前的路径中。</span><br></pre></td></tr></table></figure>
<h2 id="了解文本宽度计算（知道有）"><a href="#了解文本宽度计算（知道有）" class="headerlink" title="了解文本宽度计算（知道有）"></a>了解文本宽度计算（知道有）</h2><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">context</span>.measureText(<span class="literal">text</span>).<span class="literal">width</span>;</span><br></pre></td></tr></table></figure>
<h2 id="如果以后做canvas游戏方向开发深入学习可以扩展内以下容："><a href="#如果以后做canvas游戏方向开发深入学习可以扩展内以下容：" class="headerlink" title="如果以后做canvas游戏方向开发深入学习可以扩展内以下容："></a>如果以后做canvas游戏方向开发深入学习可以扩展内以下容：</h2><ul>
<li>setTransform()  将当前转换重置为单位矩阵。然后运行 transform()</li>
<li>transform() 替换绘图的当前转换矩阵</li>
<li>globalCompositeOperation    设置或返回新图像如何绘制到已有的图像上</li>
<li>像素操作</li>
</ul>
<h1 id="Canvas开发库封装"><a href="#Canvas开发库封装" class="headerlink" title="Canvas开发库封装"></a>Canvas开发库封装</h1><h2 id="封装常用的绘制函数"><a href="#封装常用的绘制函数" class="headerlink" title="封装常用的绘制函数"></a>封装常用的绘制函数</h2><h3 id="封装一个矩形"><a href="#封装一个矩形" class="headerlink" title="封装一个矩形"></a>封装一个矩形</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//思考：我们用到的矩形需要哪些绘制的东西呢？</span></span><br><span class="line"><span class="number">1</span>、矩形的 x、y坐标</span><br><span class="line"><span class="number">2</span>、矩形的宽高</span><br><span class="line"><span class="number">3</span>、矩形的边框的线条样式、线条宽度</span><br><span class="line"><span class="number">4</span>、矩形填充的样式</span><br><span class="line"><span class="number">5</span>、矩形的旋转角度</span><br><span class="line"><span class="number">6</span>、矩形的缩小放大</span><br><span class="line"><span class="comment">//下面是把上面所有的功能进行封装的代码：</span></span><br><span class="line">function ItcastRect( option ) &#123;<span class="comment">//矩形构造函数</span></span><br><span class="line">    <span class="keyword">this</span>._init(option);</span><br><span class="line">&#125;</span><br><span class="line">ItcastRect.prototype = &#123;  <span class="comment">//矩形的原型对象</span></span><br><span class="line">    _init: function( option ) &#123;  <span class="comment">//初始化方法</span></span><br><span class="line">        option = option || &#123;&#125;;</span><br><span class="line">        <span class="keyword">this</span>.x = option.x === <span class="number">0</span> ? <span class="number">0</span> : option.x || <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.y = option.y === <span class="number">0</span> ? <span class="number">0</span> : option.y || <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.w = option.w || <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.h = option.h || <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.angle = option.angle === <span class="number">0</span> ? <span class="number">0</span> : option.angle || <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.fillStyle = option.fillStyle || <span class="string">'silver'</span>;</span><br><span class="line">        <span class="keyword">this</span>.strokeStyle = option.strokeStyle || <span class="string">'red'</span>;</span><br><span class="line">        <span class="keyword">this</span>.strokeWidth = option.strokeWidth || <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">this</span>.scaleX = option.scaleX || <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">this</span>.scaleY = option.Y || <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    render: function( ctx ) &#123;<span class="comment">//把矩形渲染到canvas中</span></span><br><span class="line">        ctx.save();</span><br><span class="line">        ctx.translate( <span class="keyword">this</span>.x, <span class="keyword">this</span>.y );<span class="comment">//位移画布</span></span><br><span class="line">        ctx.rotate( <span class="keyword">this</span>.angle * Math.PI / <span class="number">180</span> );<span class="comment">//旋转角度</span></span><br><span class="line">        ctx.scale( <span class="keyword">this</span>.scaleX, <span class="keyword">this</span>.scaleY );<span class="comment">//缩放</span></span><br><span class="line">        ctx.fillStyle = <span class="keyword">this</span>.fillStyle;</span><br><span class="line">        ctx.fillRect( <span class="number">0</span>, <span class="number">0</span>, <span class="keyword">this</span>.w, <span class="keyword">this</span>.h ); <span class="comment">//填充矩形</span></span><br><span class="line">        ctx.lineWidth = <span class="keyword">this</span>.strokeWidth;     <span class="comment">//线宽</span></span><br><span class="line">        ctx.strokeStyle = <span class="keyword">this</span>.strokeStyle;   <span class="comment">//填充样式</span></span><br><span class="line">        ctx.strokeRect( <span class="number">0</span>,<span class="number">0</span>,<span class="keyword">this</span>.w,<span class="keyword">this</span>.h );  <span class="comment">//描边样式</span></span><br><span class="line">        ctx.restore();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">constructor</span>: ItcastRect</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>4.1.2作业：尝试着封装一个圆形？</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//封装圆形的代码的答案：不要偷看</span></span><br><span class="line">function ItcastCircle( option ) &#123;</span><br><span class="line">    <span class="keyword">this</span>._init( option );</span><br><span class="line">&#125;</span><br><span class="line">ItcastCircle.prototype = &#123;</span><br><span class="line">    _init: function( option ) &#123;</span><br><span class="line">        option = option || &#123;&#125;;</span><br><span class="line">        <span class="keyword">this</span>.x = option.x === <span class="number">0</span> ? <span class="number">0</span> : option.x || <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.y = option.y === <span class="number">0</span> ? <span class="number">0</span> : option.y || <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.w = option.w || <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.h = option.h || <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.angle = option.angle === <span class="number">0</span> ? <span class="number">0</span> : option.angle || <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.fillStyle = option.fillStyle || <span class="string">'silver'</span>;</span><br><span class="line">        <span class="keyword">this</span>.strokeStyle = option.strokeStyle || <span class="string">'red'</span>;</span><br><span class="line">        <span class="keyword">this</span>.strokeWidth = option.strokeWidth || <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">this</span>.scaleX = option.scaleX || <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">this</span>.scaleY = option.Y || <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">this</span>.opactity = option.opactity || <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">this</span>.counterclockwise = </span><br><span class="line">            option.counterclockwise === <span class="literal">true</span> ? <span class="literal">true</span> : option.counterclockwise || <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">this</span>.startAngle = option.startAngle == <span class="number">0</span> ? <span class="number">0</span> : option.startAngle || <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.endAngle = option.endAngle == <span class="number">0</span> ? <span class="number">0</span> : option.endAngle || <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.startAngle = <span class="keyword">this</span>.startAngle * Math.PI/<span class="number">180</span>;</span><br><span class="line">        <span class="keyword">this</span>.endAngle = <span class="keyword">this</span>.endAngle * Math.PI / <span class="number">180</span>;</span><br><span class="line">        <span class="keyword">this</span>.r = option.r || <span class="number">100</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    render: function( ctx ) &#123;</span><br><span class="line">        ctx.save();</span><br><span class="line">        ctx.translate( <span class="keyword">this</span>.x, <span class="keyword">this</span>.y);</span><br><span class="line">        ctx.scale( <span class="keyword">this</span>.scaleX, <span class="keyword">this</span>.scaleY );</span><br><span class="line">        ctx.rotate( <span class="keyword">this</span>.agnle * Math.PI / <span class="number">180</span> );</span><br><span class="line">        ctx.globalAlpha = <span class="keyword">this</span>.opacity;</span><br><span class="line">        ctx.fillStyle = <span class="keyword">this</span>.fillStyle;</span><br><span class="line">        ctx.strokeStyle = <span class="keyword">this</span>.strokeStyle;</span><br><span class="line">        ctx.moveTo(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        ctx.arc( <span class="number">0</span>, <span class="number">0</span>, <span class="keyword">this</span>.r, <span class="keyword">this</span>.startAngle, <span class="keyword">this</span>.endAngle, <span class="keyword">this</span>.counterclockwise);</span><br><span class="line">        ctx.fill();</span><br><span class="line">        ctx.stroke();</span><br><span class="line">        ctx.restore();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">constructor</span>: ItcastCircle</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="第三方库使用"><a href="#第三方库使用" class="headerlink" title="第三方库使用"></a>第三方库使用</h2><ul>
<li>Rgraph vs 百度的echart</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>roopons.com.au<span class="regexp">/wp-content/</span>plugins<span class="regexp">/viral-optins/</span>js<span class="regexp">/rgraph/</span></span><br></pre></td></tr></table></figure>
<ul>
<li>国产的egret引擎</li>
</ul>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>//www.egret-labs<span class="meta">.org</span>/</span><br></pre></td></tr></table></figure>
<ul>
<li>比较火的3d引擎：treejs</li>
</ul>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>//threejs<span class="meta">.org</span>/</span><br></pre></td></tr></table></figure>
<ul>
<li>Konva</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">官网：http:<span class="comment">//konvajs.github.io/</span></span><br><span class="line">    特点：</span><br><span class="line"><span class="comment">     * 小巧、使用方便、适合移动端和pc端</span></span><br><span class="line"><span class="comment">     * 支持丰富的事件处理操作</span></span><br><span class="line"><span class="comment">     * 支持类似JQuery的操作方式（顺带能复习jQueyr）</span></span><br><span class="line"><span class="comment">     * 开源，可以随意更改</span></span><br><span class="line"><span class="comment">     * 社区更新比较活跃，github托管源码</span></span><br><span class="line"><span class="comment">     * 性能也不错</span></span><br></pre></td></tr></table></figure>
<ul>
<li>其他的还有很多，希望以后能用到你们的库。</li>
</ul>
<h1 id="Konva的使用快速上手"><a href="#Konva的使用快速上手" class="headerlink" title="Konva的使用快速上手"></a>Konva的使用快速上手</h1><h2 id="Konva的整体理念"><a href="#Konva的整体理念" class="headerlink" title="Konva的整体理念"></a>Konva的整体理念</h2><ul>
<li>舞台的概念的引入。整个视图看做是一个舞台 stage</li>
<li>舞台中可以绘制很多个层 layer</li>
<li>layer下面可以有很多的group</li>
<li>group下面可以有 矩形、图片、其他形状等</li>
<li>参看：快速上手文档—查看翻译文档</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">              Stage</span><br><span class="line">                |</span><br><span class="line">         +------+------+</span><br><span class="line">         |             |</span><br><span class="line">       Layer         Layer</span><br><span class="line">         |             |</span><br><span class="line">   +-----+-----+     Shape</span><br><span class="line">   |           |</span><br><span class="line"><span class="built_in"> Group </span>      Group</span><br><span class="line">   |           |</span><br><span class="line">   +       +---+---+</span><br><span class="line">   |       |       |</span><br><span class="line">Shape  <span class="built_in"> Group </span>   Shape</span><br><span class="line">           |</span><br><span class="line">           +</span><br><span class="line">           |</span><br><span class="line">         Shape</span><br></pre></td></tr></table></figure>
<h2 id="Konva矩形案例"><a href="#Konva矩形案例" class="headerlink" title="Konva矩形案例"></a>Konva矩形案例</h2><h3 id="创建一个矩形：-Konva-Rect-option"><a href="#创建一个矩形：-Konva-Rect-option" class="headerlink" title="创建一个矩形： Konva.Rect(option);"></a>创建一个矩形： Konva.Rect(option);</h3><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Konva使用的基本案例</span></span><br><span class="line"><span class="comment">//第一步：创建舞台</span></span><br><span class="line">var stage = <span class="keyword">new</span> Konva.Stage(&#123;</span><br><span class="line">    container: <span class="string">'container'</span>,     <span class="comment">//需要存放舞台的Dom容器</span></span><br><span class="line">    <span class="built_in">width</span>: window.innerWidth,   <span class="comment">//设置全屏</span></span><br><span class="line">    <span class="built_in">height</span>: window.innerHeight</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//第二步：创建层</span></span><br><span class="line">var layer = <span class="keyword">new</span> Konva.Layer();  <span class="comment">//创建一个层</span></span><br><span class="line">stage.<span class="built_in">add</span>(layer);               <span class="comment">//把层添加到舞台</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//第三步： 创建矩形</span></span><br><span class="line">var <span class="built_in">rect</span> = <span class="keyword">new</span> Konva.Rect(&#123;     <span class="comment">//创建一个矩形</span></span><br><span class="line">    x: <span class="number">100</span>,                     <span class="comment">//矩形的x坐标，相对其父容器的坐标</span></span><br><span class="line">    y: <span class="number">100</span>,                      </span><br><span class="line">    <span class="built_in">width</span>: <span class="number">100</span>,                 <span class="comment">//矩形的宽度</span></span><br><span class="line">    <span class="built_in">height</span>: <span class="number">100</span>,                <span class="comment">//矩形高度</span></span><br><span class="line">    <span class="built_in">fill</span>: <span class="string">'gold'</span>,               <span class="comment">//矩形填充的颜色</span></span><br><span class="line">    <span class="built_in">stroke</span>: <span class="string">'navy'</span>,             <span class="comment">//矩形描边的颜色</span></span><br><span class="line">    strokeWidth: <span class="number">4</span>,             <span class="comment">//填充宽度</span></span><br><span class="line">    opactity: <span class="number">.2</span>,               <span class="comment">//矩形的透明度</span></span><br><span class="line">    <span class="built_in">scale</span>: <span class="number">1.2</span>,                 <span class="comment">//矩形的缩放 1：原来大小</span></span><br><span class="line">    rotation: <span class="number">30</span>,               <span class="comment">//旋转的角度，是deg不是弧度。</span></span><br><span class="line">    cornerRadius: <span class="number">10</span>,           <span class="comment">//圆角的大小（像素） </span></span><br><span class="line">    id: <span class="string">'rect1'</span>,                <span class="comment">//id属性，类似dom的id属性</span></span><br><span class="line">    name: <span class="string">'rect'</span>,</span><br><span class="line">    draggable: <span class="keyword">true</span>             <span class="comment">//是否可以进行拖拽</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个组</span></span><br><span class="line">var group = <span class="keyword">new</span> Konva.Group(&#123;</span><br><span class="line">    x: <span class="number">40</span>,      </span><br><span class="line">    y: <span class="number">40</span>,</span><br><span class="line">&#125;);</span><br><span class="line">group.<span class="built_in">add</span>( <span class="built_in">rect</span> );  <span class="comment">//把矩形添加到组中</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//第四步： 把形状放到层中</span></span><br><span class="line">layer.<span class="built_in">add</span>( group ); <span class="comment">//把组添加到层中</span></span><br><span class="line">layer.<span class="title">draw</span>();       <span class="comment">//绘制层到舞台上</span></span><br></pre></td></tr></table></figure>
<h2 id="Konva的动画系统"><a href="#Konva的动画系统" class="headerlink" title="Konva的动画系统"></a>Konva的动画系统</h2><h3 id="tween对象-重点"><a href="#tween对象-重点" class="headerlink" title="tween对象(重点)"></a>tween对象(重点)</h3><ul>
<li>tween，英文意思：两者之间， 英 [twiːn]   美 [twin]</li>
<li>tween是控制Konva对象进行动画的核心对象。</li>
<li>tween可以控制所有数字类型的属性进行动画处理，比如：x, y, rotation,<br>width, height, radius, strokeWidth, opacity, scaleX等</li>
</ul>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//案例：</span></span><br><span class="line">var tween = new Konva.Tween(&#123;</span><br><span class="line"><span class="symbol">    node:</span> rect,             <span class="comment">//要进行动画的Konva对象</span></span><br><span class="line"><span class="symbol">    x:</span> <span class="number">300</span>,                 <span class="comment">//要进行动画的属性</span></span><br><span class="line"><span class="symbol">    opacity:</span> <span class="number">.8</span>,            </span><br><span class="line"><span class="symbol">    duration:</span> <span class="number">1</span>,            <span class="comment">//持续时间</span></span><br><span class="line"><span class="symbol">    easing:</span> Konva.Easings.EaseIn, <span class="comment">//动画的动画效果</span></span><br><span class="line"><span class="symbol">    yoyo:</span> true,             <span class="comment">//是否进行循环播放的设置</span></span><br><span class="line"><span class="symbol">    onFinish:</span> function() &#123;</span><br><span class="line">        <span class="comment">//动画执行结束后，执行此方法</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">tween.play();   <span class="comment">//启动动画</span></span><br></pre></td></tr></table></figure>
<ul>
<li>tween的控制方法<ul>
<li>tween.play(),     //播放动画</li>
<li>tween.pause(),    //暂停动画</li>
<li>tween.reverse(),  //动画逆播放</li>
<li>tween.reset(),    //重置动画</li>
<li>tween.finish(),   //立即结束动画</li>
<li>seek：英文：寻找 英 [siːk]   美 [sik]</li>
</ul>
</li>
<li>tween的缓动控制选项<ul>
<li>Konva.Easings.Linear            //线性</li>
<li>Konva.Easings.EaseIn            //缓动，先慢后快</li>
<li>Konva.Easings.EaseOut //先快后慢</li>
<li>Konva.Easings.EaseInOut //两头慢，中间快</li>
<li>Konva.Easings.BackEaseIn //往回来一点，然后往前冲，汽车启动类似…</li>
<li>Konva.Easings.BackEaseOut</li>
<li>Konva.Easings.BackEaseInOut </li>
<li>Konva.Easings.ElasticEaseIn  //橡皮筋 英 [ɪ’læstɪk]   美 [ɪ’læstɪk] </li>
<li>Konva.Easings.ElasticEaseOut </li>
<li>Konva.Easings.ElasticEaseInOut </li>
<li>Konva.Easings.BounceEaseIn   //弹跳；弹起，反跳；弹回  英 [baʊns]   美 [baʊns]</li>
<li>Konva.Easings.BounceEaseOut </li>
<li>Konva.Easings.BounceEaseInOut </li>
<li>Konva.Easings.StrongEaseIn //强力</li>
<li>Konva.Easings.StrongEaseOut </li>
<li>Konva.Easings.StrongEaseInOut </li>
</ul>
</li>
<li>动画效果参考： 29Konva动画缓动效果案例.html</li>
</ul>
<h3 id="动画to的使用"><a href="#动画to的使用" class="headerlink" title="动画to的使用"></a>动画to的使用</h3><ul>
<li>to就是对tween的封装，比较简单好用。</li>
</ul>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//案例：</span></span><br><span class="line">var <span class="built_in">rect</span> = <span class="keyword">new</span> Konva.Rect(&#123;</span><br><span class="line">    x: <span class="number">10</span>,</span><br><span class="line">    y: <span class="number">10</span>,</span><br><span class="line">    <span class="built_in">width</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="built_in">height</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="built_in">fill</span>: <span class="string">'red'</span></span><br><span class="line">&#125;);</span><br><span class="line">layer.<span class="built_in">add</span>(<span class="built_in">rect</span>);</span><br><span class="line">layer.<span class="title">draw</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//动画系统</span></span><br><span class="line"><span class="built_in">rect</span>.to(&#123;</span><br><span class="line">    x: <span class="number">100</span>,</span><br><span class="line">    y: <span class="number">100</span>,</span><br><span class="line">    opactity: <span class="number">.1</span>,</span><br><span class="line">    duration: <span class="number">3</span>,</span><br><span class="line">    onFinish: function() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//to: 就是对tween的简单应用。</span></span><br></pre></td></tr></table></figure>
<h3 id="Animate的应用"><a href="#Animate的应用" class="headerlink" title="Animate的应用"></a>Animate的应用</h3><ul>
<li>Animation动画，实际上就是浏览器通知开发者进行绘制，并提供当前的时间</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> anim = <span class="keyword">new</span> Konva.Animation(<span class="function"><span class="keyword">function</span><span class="params">(frame)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//动画系统提供的frame有三个属性可以使用：</span></span><br><span class="line">    <span class="keyword">var</span> time = frame.time, <span class="comment">// 动画执行的总时间</span></span><br><span class="line">        timeDiff = frame.timeDiff, <span class="comment">// 距离上一帧的时间</span></span><br><span class="line">        frameRate = frame.frameRate; <span class="comment">// 帧率（既1000/间隔时间）</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">//动画的动作</span></span><br><span class="line"></span><br><span class="line">&#125;, layer);</span><br><span class="line"></span><br><span class="line">anim.start();<span class="comment">//启动动画</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//anim.stop();//结束动画</span></span><br></pre></td></tr></table></figure>
<h3 id="循环播放动画的实现"><a href="#循环播放动画的实现" class="headerlink" title="循环播放动画的实现"></a>循环播放动画的实现</h3><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//总体思路，使用tween 配合onFinish事件中重新播放动画，达到循环播放的效果</span></span><br><span class="line"><span class="keyword">var</span> loopTween = <span class="keyword">new</span> Konva.Tween(&#123;</span><br><span class="line">    node: star, <span class="comment">//设置要表现动画的 Konva对象</span></span><br><span class="line">    rotation: <span class="number">360</span>,  <span class="comment">//旋转360度</span></span><br><span class="line">    duration: <span class="number">2</span>,    <span class="comment">//动画持续时间</span></span><br><span class="line">    easing: Konva.Easings.Linear,</span><br><span class="line">    onFinish: <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// this === loopTween //true</span></span><br><span class="line">        <span class="keyword">this</span>.reset();<span class="comment">//重置动画</span></span><br><span class="line">        <span class="keyword">this</span>.play(); <span class="comment">//重新播放动画</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">loopTween.play();</span><br></pre></td></tr></table></figure>
<h3 id="回放且循环播放动画"><a href="#回放且循环播放动画" class="headerlink" title="回放且循环播放动画"></a>回放且循环播放动画</h3><ul>
<li>yoyo属性可以进行对动画进行播放完后，回放当前动画，并持续循环来回切换播放。</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">rect</span><span class="selector-class">.to</span>(&#123;</span><br><span class="line">    <span class="attribute">duration</span>: <span class="number">2</span>,</span><br><span class="line">    scale: <span class="number">1.5</span>,</span><br><span class="line">    yoyo: true// 此设置也可以用于 tween</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="进度条案例"><a href="#进度条案例" class="headerlink" title="进度条案例"></a>进度条案例</h3><h3 id="传智官网案例"><a href="#传智官网案例" class="headerlink" title="传智官网案例"></a>传智官网案例</h3><ul>
<li>三角函数的补充<ul>
<li>Math.sin(弧度); //夹角对面的边 和 斜边的比值</li>
<li>Math.cos(弧度); //夹角侧边 与斜边的比值</li>
</ul>
</li>
<li>圆形上面的点的坐标的计算公式<ul>
<li>x =x0 + Math.cos(rad) * R;//x0和y0是圆心点坐标</li>
<li>y =y0 + Math.sin(rad) * R;//注意都是弧度<br><img src="/2019-05-11/canvas/圆形点的坐标计算公式.png" alt="圆形点的坐标计算公式"></li>
</ul>
</li>
<li>group的灵活运用<ul>
<li>konva的group很灵活，每个group都有自己的坐标系</li>
<li>group可以包含其他的group，可以对group做整个组的动画</li>
<li>group可以通过getChidren();//可以拿到直接子级元素。</li>
</ul>
</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var<span class="built_in"> group </span>= new Konva.Group(&#123;</span><br><span class="line">    x: 0,</span><br><span class="line">    y: 0</span><br><span class="line">&#125;);</span><br><span class="line">group.<span class="builtin-name">add</span>(rect);</span><br></pre></td></tr></table></figure>
<h2 id="Konva的事件（重要）"><a href="#Konva的事件（重要）" class="headerlink" title="Konva的事件（重要）"></a>Konva的事件（重要）</h2><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">rect</span> = <span class="keyword">new</span> Konva.Rect(&#123;</span><br><span class="line">    <span class="attribute">x</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="attribute">y</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="attribute">fill</span>: <span class="string">'red'</span>,</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//绑定事件 Konva支持事件：mouseover, mouseout, mouseenter, mouseleave, mousemove, mousedown, mouseup, mousewheel, click, dblclick, dragstart, dragmove, and dragend</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">rect</span>.on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;   <span class="comment">//jQuery一模一样！！</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'^_^  ^_^'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//绑定多个事件</span></span><br><span class="line"><span class="built_in">rect</span>.on(<span class="string">'click mousemove'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//解除绑定事件</span></span><br><span class="line"><span class="built_in">rect</span>.off(<span class="string">'click'</span>);             <span class="comment">//这不是jQuery吗？</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//触发事件</span></span><br><span class="line"><span class="built_in">rect</span>.fire(<span class="string">'click'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//取消事件冒泡</span></span><br><span class="line"><span class="built_in">rect</span>.on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">'You clicked the circle!'</span>);</span><br><span class="line">  evt.cancelBubble = <span class="literal">true</span>;      <span class="comment">//取消事件冒泡</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Konva的选择器"><a href="#Konva的选择器" class="headerlink" title="Konva的选择器"></a>Konva的选择器</h2><ul>
<li>选择方法。<ul>
<li>ID选择法：stage.find(‘#id’); //此方法返回的是一个数组</li>
<li>name选择法：group.findOne(‘.name’);//返回一个Konva对象</li>
<li>type选择法： group.find(‘Circle’);//查找所有的圆形Konva对象</li>
</ul>
</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//组中查找圆形的Konva对象</span></span><br><span class="line">groupCircle.find(<span class="string">'Circle'</span>).each(<span class="function"><span class="keyword">function</span><span class="params">( circle, <span class="keyword">index</span> )</span><span class="comment">&#123;</span></span></span><br><span class="line"><span class="function"><span class="comment">    circle.setZIndex( 3 - index );</span></span></span><br><span class="line"><span class="function"><span class="comment">&#125;</span>);</span></span><br></pre></td></tr></table></figure>
<h3 id="饼状图案例"><a href="#饼状图案例" class="headerlink" title="饼状图案例"></a>饼状图案例</h3><ul>
<li>wedge: 楔形</li>
</ul>
<h3 id="柱状图案例"><a href="#柱状图案例" class="headerlink" title="柱状图案例"></a>柱状图案例</h3><ul>
<li>histogram n. [统计] 直方图；柱状图  英 [‘hɪstəgræm]   美 [‘hɪstəɡræm]</li>
</ul>
<h1 id="Canvas项目实战"><a href="#Canvas项目实战" class="headerlink" title="Canvas项目实战"></a>Canvas项目实战</h1><h1 id="Canvas优化"><a href="#Canvas优化" class="headerlink" title="Canvas优化"></a>Canvas优化</h1><hr>
      
    </div>

    <div>
      
        

      
    </div>
  
        <div class="post-tags">
          
            <a href="/tags/canvas/" rel="tag"><i class="fa fa-tag"></i> canvas</a>
          
        </div>
      


    <div>
      
        

      
    </div>


    <footer class="post-footer">

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019-05-11/DataStructureAssign.html" rel="prev" title="数据结构课程设计-平衡二叉树">
                <i class="fa fa-chevron-left"></i> 数据结构课程设计-平衡二叉树
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019-05-11/web-bootstrap.html" rel="next" title="bootstrap开发实例">
                 bootstrap开发实例 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
 <a href="/">
          <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="林加鸿">
</a>
          <p class="site-author-name" itemprop="name">林加鸿</p>
          <p class="site-description motion-element" itemprop="description">欢迎来到Abo的博客，博客以分享前端web知识、数据结构与算法、计算机基础为主，希望能帮到您ㄟ(😀)ㄏ</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">63</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">20</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">58</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/jhjhljh" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/jhjhljh" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/jhjhljh" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-battery-3"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              神奇的链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://music.163.com/#/user/home?id=84597901" title="😆 网易云音乐 😆" target="_blank">😆 网易云音乐 😆</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.taylorswift.com/" title="😋Taylor Swift Official Website😋" target="_blank">😋Taylor Swift Official Website😋</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://tophub.today/" title="今日热榜(各大网站)" target="_blank">今日热榜(各大网站)</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.bilibili.com/video/av46959835/" title="独狼(Lone Wolf)——献给那些独自行走的人" target="_blank">独狼(Lone Wolf)——献给那些独自行走的人</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://jhjhljh.github.io/about/" title="关于此博客" target="_blank">关于此博客</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#canvas简介"><span class="nav-number">1.</span> <span class="nav-text">canvas简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是canvas？（了解）"><span class="nav-number">1.1.</span> <span class="nav-text">什么是canvas？（了解）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#canvas主要应用的领域（了解）"><span class="nav-number">1.2.</span> <span class="nav-text">canvas主要应用的领域（了解）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#canvas绘图基础"><span class="nav-number">2.</span> <span class="nav-text">canvas绘图基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#sublime配置canvas插件（推荐）"><span class="nav-number">2.1.</span> <span class="nav-text">sublime配置canvas插件（推荐）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Canvas标签"><span class="nav-number">2.2.</span> <span class="nav-text">Canvas标签</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#canvas标签语法和属性-（重点）"><span class="nav-number">2.2.1.</span> <span class="nav-text">canvas标签语法和属性  （重点）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#浏览器不兼容处理（重点）"><span class="nav-number">2.2.2.</span> <span class="nav-text">浏览器不兼容处理（重点）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#canvas绘图上下文context"><span class="nav-number">2.3.</span> <span class="nav-text">canvas绘图上下文context</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Context：Canvas的上下文、绘制环境。（重点掌握）"><span class="nav-number">2.3.1.</span> <span class="nav-text">Context：Canvas的上下文、绘制环境。（重点掌握）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本的绘制路径（重点）"><span class="nav-number">2.4.</span> <span class="nav-text">基本的绘制路径（重点）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#canvas坐标系"><span class="nav-number">2.4.1.</span> <span class="nav-text">canvas坐标系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#设置绘制起点-moveTo"><span class="nav-number">2.4.2.</span> <span class="nav-text">设置绘制起点(moveTo)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#绘制直线-lineTo"><span class="nav-number">2.4.3.</span> <span class="nav-text">绘制直线(lineTo)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#路径开始和闭合"><span class="nav-number">2.4.4.</span> <span class="nav-text">路径开始和闭合</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#描边-stroke"><span class="nav-number">2.4.5.</span> <span class="nav-text">描边(stroke)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#填充-fill"><span class="nav-number">2.4.6.</span> <span class="nav-text">填充(fill)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#快速创建矩形rect-方法"><span class="nav-number">2.4.7.</span> <span class="nav-text">快速创建矩形rect()方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#快速创建描边矩形和填充矩形"><span class="nav-number">2.4.8.</span> <span class="nav-text">快速创建描边矩形和填充矩形</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#清除矩形-clearRect"><span class="nav-number">2.4.9.</span> <span class="nav-text">清除矩形(clearRect)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#绘制圆形（arc"><span class="nav-number">2.5.</span> <span class="nav-text">绘制圆形（arc)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#绘制文字（会使用就可以了）"><span class="nav-number">2.6.</span> <span class="nav-text">绘制文字（会使用就可以了）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#绘制上下文的文字属性-（有印象就行了）"><span class="nav-number">2.6.1.</span> <span class="nav-text">绘制上下文的文字属性 （有印象就行了）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#上下文绘制文字方法"><span class="nav-number">2.6.2.</span> <span class="nav-text">上下文绘制文字方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#绘制图片（drawImage）-（重点）"><span class="nav-number">2.7.</span> <span class="nav-text">绘制图片（drawImage）  （重点）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本绘制图片的方式"><span class="nav-number">2.7.1.</span> <span class="nav-text">基本绘制图片的方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#在画布上绘制图像，并规定图像的宽度和高度"><span class="nav-number">2.7.2.</span> <span class="nav-text">在画布上绘制图像，并规定图像的宽度和高度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#图片裁剪，并在画布上定位被剪切的部分"><span class="nav-number">2.7.3.</span> <span class="nav-text">图片裁剪，并在画布上定位被剪切的部分</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#用JavaScript创建img对象"><span class="nav-number">2.7.4.</span> <span class="nav-text">用JavaScript创建img对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#面向对象基础复习补充："><span class="nav-number">2.7.5.</span> <span class="nav-text">面向对象基础复习补充：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#补充-sublime制作代码段（推荐–已结讲过了）"><span class="nav-number">2.8.</span> <span class="nav-text">补充 sublime制作代码段（推荐–已结讲过了）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#canvas进阶"><span class="nav-number">3.</span> <span class="nav-text">canvas进阶</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Canvas颜色样式和阴影"><span class="nav-number">3.1.</span> <span class="nav-text">Canvas颜色样式和阴影</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#设置填充和描边的颜色（掌握）"><span class="nav-number">3.1.1.</span> <span class="nav-text">设置填充和描边的颜色（掌握）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#设置阴影（了解，少用，性能差）"><span class="nav-number">3.1.2.</span> <span class="nav-text">设置阴影（了解，少用，性能差）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#复杂样式（了解）"><span class="nav-number">3.2.</span> <span class="nav-text">复杂样式（了解）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建线性渐变的样式（了解）"><span class="nav-number">3.2.1.</span> <span class="nav-text">创建线性渐变的样式（了解）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#设置圆形渐变（径向渐变）-了解"><span class="nav-number">3.2.2.</span> <span class="nav-text">设置圆形渐变（径向渐变） 了解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#绘制背景图（了解）"><span class="nav-number">3.2.3.</span> <span class="nav-text">绘制背景图（了解）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#变换（重点）"><span class="nav-number">3.3.</span> <span class="nav-text">变换（重点）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#缩放（重点）"><span class="nav-number">3.3.1.</span> <span class="nav-text">缩放（重点）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#位移画布（重点）"><span class="nav-number">3.3.2.</span> <span class="nav-text">位移画布（重点）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#旋转（重点）"><span class="nav-number">3.3.3.</span> <span class="nav-text">旋转（重点）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#绘制环境保存和还原（重要）"><span class="nav-number">3.4.</span> <span class="nav-text">绘制环境保存和还原（重要）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#设置绘制环境的透明度（了解）"><span class="nav-number">3.5.</span> <span class="nav-text">设置绘制环境的透明度（了解）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#画布限定区域绘制（了解）"><span class="nav-number">3.6.</span> <span class="nav-text">画布限定区域绘制（了解）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#画布保存base64编码内容（重要）"><span class="nav-number">3.7.</span> <span class="nav-text">画布保存base64编码内容（重要）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#画布渲染画布（重要）"><span class="nav-number">3.8.</span> <span class="nav-text">画布渲染画布（重要）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#了解：线条样式（了解）"><span class="nav-number">3.9.</span> <span class="nav-text">了解：线条样式（了解）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#了解贝塞尔曲线（知道有）"><span class="nav-number">3.10.</span> <span class="nav-text">了解贝塞尔曲线（知道有）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#绘制一条二次方曲线。"><span class="nav-number">3.10.1.</span> <span class="nav-text">绘制一条二次方曲线。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#绘制贝塞尔曲线（知道有）"><span class="nav-number">3.10.2.</span> <span class="nav-text">绘制贝塞尔曲线（知道有）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#了解创建两条切线的弧（知道有）"><span class="nav-number">3.11.</span> <span class="nav-text">了解创建两条切线的弧（知道有）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#了解判断点是否在路径中（知道有）"><span class="nav-number">3.12.</span> <span class="nav-text">了解判断点是否在路径中（知道有）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#了解文本宽度计算（知道有）"><span class="nav-number">3.13.</span> <span class="nav-text">了解文本宽度计算（知道有）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如果以后做canvas游戏方向开发深入学习可以扩展内以下容："><span class="nav-number">3.14.</span> <span class="nav-text">如果以后做canvas游戏方向开发深入学习可以扩展内以下容：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Canvas开发库封装"><span class="nav-number">4.</span> <span class="nav-text">Canvas开发库封装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#封装常用的绘制函数"><span class="nav-number">4.1.</span> <span class="nav-text">封装常用的绘制函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#封装一个矩形"><span class="nav-number">4.1.1.</span> <span class="nav-text">封装一个矩形</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第三方库使用"><span class="nav-number">4.2.</span> <span class="nav-text">第三方库使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Konva的使用快速上手"><span class="nav-number">5.</span> <span class="nav-text">Konva的使用快速上手</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Konva的整体理念"><span class="nav-number">5.1.</span> <span class="nav-text">Konva的整体理念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Konva矩形案例"><span class="nav-number">5.2.</span> <span class="nav-text">Konva矩形案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建一个矩形：-Konva-Rect-option"><span class="nav-number">5.2.1.</span> <span class="nav-text">创建一个矩形： Konva.Rect(option);</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Konva的动画系统"><span class="nav-number">5.3.</span> <span class="nav-text">Konva的动画系统</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#tween对象-重点"><span class="nav-number">5.3.1.</span> <span class="nav-text">tween对象(重点)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#动画to的使用"><span class="nav-number">5.3.2.</span> <span class="nav-text">动画to的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Animate的应用"><span class="nav-number">5.3.3.</span> <span class="nav-text">Animate的应用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#循环播放动画的实现"><span class="nav-number">5.3.4.</span> <span class="nav-text">循环播放动画的实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#回放且循环播放动画"><span class="nav-number">5.3.5.</span> <span class="nav-text">回放且循环播放动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#进度条案例"><span class="nav-number">5.3.6.</span> <span class="nav-text">进度条案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#传智官网案例"><span class="nav-number">5.3.7.</span> <span class="nav-text">传智官网案例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Konva的事件（重要）"><span class="nav-number">5.4.</span> <span class="nav-text">Konva的事件（重要）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Konva的选择器"><span class="nav-number">5.5.</span> <span class="nav-text">Konva的选择器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#饼状图案例"><span class="nav-number">5.5.1.</span> <span class="nav-text">饼状图案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#柱状图案例"><span class="nav-number">5.5.2.</span> <span class="nav-text">柱状图案例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Canvas项目实战"><span class="nav-number">6.</span> <span class="nav-text">Canvas项目实战</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Canvas优化"><span class="nav-number">7.</span> <span class="nav-text">Canvas优化</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">
  
  &copy;  2018 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="heart">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">林加鸿</span>
</div>






        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user-circle-o"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><span class="busuanzi-value" id="busuanzi_value_site_pv"></span><i class="fa fa-eye"></i></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.1/velocity.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.1/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  



  




	





  





  

  
      <!-- UY BEGIN -->
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid="></script>
      <!-- UY END -->
  



  


  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("W0twhOKHT901IOCEADaiuynP-gzGzoHsz", "zQfRdGCiWzVvsSpXKOJsbvHe");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

	<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
<script>
$("body").backstretch("http://pzdbj8uw8.bkt.clouddn.com/6_29.jpg");
</script>
</body>
</html>
